<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Happy Birthday</title>

<link href="https://fonts.googleapis.com/css2?family=Dancing+Script:wght@500;600;700&display=swap" rel="stylesheet">

<style>
/* ===== YOUR ORIGINAL CSS (UNCHANGED) ===== */
html, body {
  margin: 0;
  padding: 0;
  width: 100%;
  height: 100%;
  overflow: hidden;
  font-family: 'Dancing Script', cursive;
}

body {
  margin: 0;
  min-height: 100vh;
  background-image: url("./beach.jpeg");
  background-size: cover;
  background-position: center;
  background-repeat: no-repeat;
  background-attachment: fixed;
  display: flex;
  justify-content: center;
  align-items: center;
}

.stars {
  position: fixed;
  inset: 0;
  pointer-events: none;
  z-index: 1;
}

#tapToStart {
  position: fixed;
  bottom: 40px;
  left: 50%;
  transform: translateX(-50%);
  font-size: 16px;
  color: #f5e6a8;
  text-align: center;
  z-index: 5;
  animation: blink 1.5s infinite;
}

@keyframes blink {
  0% { opacity: 1; }
  50% { opacity: 0.3; }
  100% { opacity: 1; }
}

.star {
  position: absolute;
  width: 6px;
  height: 6px;
  border-radius: 50%;
  background: white;
  box-shadow: 0 0 12px white, 0 0 30px gold;
  animation: floatStar linear infinite, twinkle 2.5s ease-in-out infinite;
}

@keyframes floatStar {
  from { transform: translateY(100vh); }
  to { transform: translateY(-10vh); }
}

@keyframes twinkle {
  0%,100% { opacity: 0.4; }
  50% { opacity: 1; }
}

.sparkle {
  position: absolute;
  width: 6px;
  height: 6px;
  background: gold;
  border-radius: 50%;
  pointer-events: none;
  box-shadow: 0 0 15px gold, 0 0 30px orange;
  animation: sparkleMove 1.8s ease-out forwards;
}

@keyframes sparkleMove {
  from { transform: scale(1) translate(0,0); opacity: 1; }
  to { transform: scale(0) translate(var(--x), var(--y)); opacity: 0; }
}

#container {
  text-align: center;
  color: #f5e6a8;
  text-shadow: 0 0 8px rgba(255, 215, 100, 0.6);
  max-width: 90%;
  z-index: 2;
}

#line {
  font-size: 1.35rem;
  line-height: 1.7;
  opacity: 0;
}

.glow {
  text-shadow: 0 0 18px rgba(255,255,255,0.9);
  animation: breathe 3s ease-in-out infinite;
}

@keyframes breathe {
  0%,100% { text-shadow: 0 0 12px rgba(255,255,255,0.6); }
  50% { text-shadow: 0 0 26px rgba(255,255,255,1); }
}

.highlight {
  color: #ffd700;
  font-size: 1.5em;
  font-weight: 600;
  text-shadow: 0 0 6px #ffd700, 0 0 12px rgba(255, 215, 0, 0.9);
}

/* ===== ‚úçÔ∏è NEW HANDWRITING MAGIC (ONLY ADDITION) ===== */
.handwrite {
  font-size: 1.6rem;
  color: #fff3b0;
  text-shadow: 0 0 35px gold, 0 0 70px orange;
}

.cursor {
  display: inline-block;
  margin-left: 5px;
  animation: blinkCursor 1s infinite;
}

@keyframes blinkCursor {
  0% { opacity: 1; }
  50% { opacity: 0; }
  100% { opacity: 1; }
}

.fadeOut {
  animation: fadeOut 1.5s ease forwards;
}

@keyframes fadeOut {
  to { opacity: 0; }
  }
/* üåë FINAL BLACKOUT */
#blackout {
  position: fixed;
  inset: 0;
  background: black;
  opacity: 0;
  pointer-events: none;
  transition: opacity 3.5s ease;
  z-index: 20;
}

#blackout.show {
  opacity: 1;
}
</style>
</head>

<body>

<div id="tapToStart">Tap anywhere to start music üéµüéµ</div>
<div class="stars" id="stars"></div>

<div id="container">
  <div id="line"></div>
</div>
<div id="blackout"></div>
<audio id="bgm" src="Happy-Birthday-To-You-Ji.mp3" preload="auto" loop></audio>

<script>
/* ‚≠ê STARS */
const stars = document.getElementById("stars");
for (let i = 0; i < 70; i++) {
  const s = document.createElement("div");
  s.className = "star";
  s.style.left = Math.random() * 100 + "vw";
  s.style.top = Math.random() * 100 + "vh";
  s.style.animationDuration = (6 + Math.random() * 6) + "s";
  stars.appendChild(s);
}

/* ‚ú® SPARKLES */
function createSparkles() {
  for (let i = 0; i < 40; i++) {
    const sp = document.createElement("div");
    sp.className = "sparkle";
    sp.style.left = "50%";
    sp.style.top = "50%";
    sp.style.setProperty("--x", (Math.random()*300 - 150) + "px");
    sp.style.setProperty("--y", (Math.random()*300 - 150) + "px");
    document.body.appendChild(sp);
    setTimeout(() => sp.remove(), 1800);
  }
}

/* üéµ MUSIC & TEXT SYNCED START */
const music = document.getElementById("bgm");
const tapText = document.getElementById("tapToStart");
let started = false;

// Pre-load the file
music.load();

async function startExperience() {
  if (started) return;
  started = true;

  tapText.style.display = "none";

  try {
    // Wait for music to play before showing text
    await music.play();
    showLine();
  } catch (err) {
    // If browser blocks, still show text so the wish works
    console.log("Audio blocked, starting text anyway");
    showLine();
  }
}

// Single reliable event listener for mobile
document.addEventListener("click", startExperience, { once: true });

/* üìù TEXT */
const lines = [
  "Hey..!! Ee roju date yentho telusa..??",
  "Today is 10th April..",
  "So ee roju mana class lo oka ammayii birthday..",
  "So konchem naa wishes thanaki convey chesthaava pls..",
  "Yevaro telusa neeku..",
  "Thanu..",
  "<span class='highlight'>C</span>huseki chaala silent gaa untundhi, but from",
  "<span class='highlight'>H</span>eart chaala ante chaala manchidhi..",
  "<span class='highlight'>A</span>anandhanga frnds tho kalisi muchatlo petukovadam ante chaaala",
  "<span class='highlight'>I</span>stam, andharu manchiga undaali ane korukuntundhi..",
  "<span class='highlight'>T</span>hana baadhanu chepi inkokarini yeppudu baadhapetadhu..",
  "<span class='highlight'>A</span>mazing character.. Totally different and matured",
  "<span class='highlight'>N</span>aaku telisinantha varaku thanaki ZERO EGO",
  "<span class='highlight'>Y</span>e okarini mosam cheyadhu, chaala loyal.. Thanu",
  "<span class='highlight'>A</span>nukunte thanakana best inkevaaru undaaru..",
  "To someone I have known for about an year..",
  "To someone whom I have rarely seen on an angry mode..",
  "To someone who is never selfish..",
  "To someone who is always humble and kind..",
  "To someone who understands without many words...",
  "To that one particular person who hasn't changed with time..",
  " So...yeah now...", 
  "__HANDWRITE__",
  "May you be blessed with THE BEST things in your life..",
  "May all your dreams come true.. Still a long way to go..",
  "Health jaagratha..",
  "Yeppudu ye vishayam gurinchi alochinchi low ga feel avaku..",
  "Yedhi jarigina mana manchike jaruguthundhi ani positive gaa tisko..",
  "And like always‚Ä¶ Be happy.. Have that smile on your face.",
  "Never let anything or anyone fade it away.",
  "Ok na...",
  "All the very best for ur life...",
  "Always be strong..",
  "Enjoy every single moment of ur life..",
  "Byeee.. Enjoy your day..."
];

let i = 0;
const lineDiv = document.getElementById("line");

function handWrite(text, callback) {
  let idx = 0;
  lineDiv.innerHTML = `<span class="handwrite"></span><span class="cursor">‚úçÔ∏è</span>`;
  const span = lineDiv.querySelector(".handwrite");

  function type() {
    if (idx < text.length) {
      span.innerHTML += text.charAt(idx);
      idx++;
      setTimeout(type, 85);
    } else {
      if(lineDiv.querySelector(".cursor")) lineDiv.querySelector(".cursor").remove();
      span.innerHTML += " ü•≥ü•≥üíêüíê";
      createSparkles();
      setTimeout(callback, 4200);
    }
  }
  type();
}

function showLine() {
  if (i >= lines.length) {
    music.pause();
    setTimeout(() => {
      document.getElementById("blackout").classList.add("show");
    }, 800);
    return;
  }

  lineDiv.className = "";
  lineDiv.style.opacity = 1;

  if (lines[i] === "__HANDWRITE__") {
    handWrite("Wishing you many more happy returns of the day Chaitanya", () => {
        setTimeout(() => {
          lineDiv.classList.add("fadeOut");
          i++;
          setTimeout(showLine, 2000);
        }, 2500);
    });
    return;
  }

  lineDiv.innerHTML = lines[i];
  lineDiv.classList.add("glow");

  setTimeout(() => lineDiv.classList.add("fadeOut"), 3600);
  setTimeout(() => { i++; showLine(); }, 4200);
}
</script>
</body>

  
</html>
